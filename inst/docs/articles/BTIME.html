<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Bayesian Hierarchical Modeling in the TIME • BTIME</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Bayesian Hierarchical Modeling in the TIME">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">BTIME</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/BTIME.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Bayesian Hierarchical Modeling in the TIME</h1>
            
      

      <div class="hidden name"><code>BTIME.Rmd</code></div>

    </div>

    
    
<p>The package <strong><em><code>BICAM</code></em></strong> uses
Bayesian hierarchical models to model abundance data for cell
populations with a predictor variable. This models each cell type
simultaneously while incorporating potential relationships between the
cell populations. The relationship utilized in this model is user
dependent based on the function inputs for setting up the covariance
structure. This package utilizes <em>rjags</em> and <em>runjags</em>
packages to run Gibbs sampling for posterior estimation.</p>
<p>Back to BTIME Repo: <a href="https://github.com/FridleyLab/BTIME" class="external-link uri">https://github.com/FridleyLab/BTIME</a></p>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>Before running this package, the JAGS (Just Another Gibbs Sampler)
program needs to be installed. You can download from <a href="https://sourceforge.net/projects/mcmc-jags/files/" class="external-link uri">https://sourceforge.net/projects/mcmc-jags/files/</a>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">BTIME</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="dataset">Dataset<a class="anchor" aria-label="anchor" href="#dataset"></a>
</h2>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dfmif</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="st">'~/mIF_Test_Data.csv'</span>, check.names <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="co"># Load in data</span></span>
<span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="va">dfmif</span> <span class="op">|&gt;</span> <span class="fu">select</span><span class="op">(</span><span class="va">suid</span>,<span class="va">total</span>,<span class="va">stage</span>,<span class="va">M1</span>,<span class="va">M2</span>,<span class="va">M3</span><span class="op">)</span> <span class="co"># Construct data to match setup of image below</span></span></code></pre></div>
<p>For setting up your data, you will want to set your data into a data
frame. The setup should be as follows:</p>
<p><em>1st column</em>: Subject IDs<br><em>2nd column</em>: Total Cell Counts<br><em>3rd column</em>: Predictor Variable<br><em>Last M columns</em>: Parameters of Interest Counts</p>
<p><strong>Example:</strong><br>
Below we have “Sub. IDs” in the first column, “Total Cell Count” in the
second column,the stage of cancer (0 = “Low” (1 or 2), &amp; 1 = “High”
(3 or 4)) as the predictor variable in the third column, and markers M1,
M2, and M3 in the last 3 columns (3 markers/parameters of interest).</p>
<center>
<img src="Data_Setup.png" height="400" width="350" alt="Graphic showing to set up the data">
</center>
</div>
<div class="section level2">
<h2 id="using-bicam">Using BICAM<a class="anchor" aria-label="anchor" href="#using-bicam"></a>
</h2>
<p><strong>Required inputs:</strong><br><em>dat</em> - Data frame containing data set constructed as shown
above<br><em>M</em> - Number of parameters/markers of interest<br><em>adapt</em> - Number of adaptation iterations for initializing JAGS
model (iterations removed from analysis)<br><em>burn</em> - Number of burn-in iterations (iterations removed from
analysis)<br><em>it</em> - Number of sampling iterations used for posterior
analysis</p>
<p><strong>Optional inputs:</strong><br><em>thin</em> - Thinning Interval (default = 1)<br><em>ran_eff</em> - 0 for NO repeated measurements, 1 FOR repeated
measurements (default = 1)<br><em>chains</em> - Number of chains to run in the JAGS model (default =
4)<br><em>cores</em> - Number of cores to use to run the JAGS model (default =
4) (must be
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mo>≥</mo><annotation encoding="application/x-tex">\geq</annotation></semantics></math>
chains for maximum efficiency)<br><em>v0_mu_logit</em> - Predicted proportion of the parameters of
interest (default = 0.01 —&gt; 1%)<br><em>model</em> - Covariance structure used in Bayesian model (default =
“Unstr”)<br><em>dis</em> - Distance matrix used for exponential decay model
(required if using exp. decay model) (default = NULL)<br><em>tree</em> - Tree-structured covariance matrix used for tree model
(required if using tree or scaled tree model) (default = NULL)</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co">##################### Unstructured Model #####################</span></span>
<span><span class="co"># posterior_unstr &lt;- BICAM(dat = dat,</span></span>
<span><span class="co">#                          M = 3,</span></span>
<span><span class="co">#                          adapt = 2000,</span></span>
<span><span class="co">#                          burn = 100,</span></span>
<span><span class="co">#                          it = 100)</span></span>
<span></span>
<span><span class="co">##################### Exponential Decay Model #####################</span></span>
<span></span>
<span><span class="co"># WILL GET ERROR IF 'dis' MATRIX IS NOT SUPPLIED. 'dis' MUST ALSO BE INVERTIBLE.</span></span>
<span></span>
<span><span class="co"># dis &lt;- matrix(c(0,1,1,</span></span>
<span><span class="co">#                  1,0,2,</span></span>
<span><span class="co">#                  1,2,0),nrow = 3)</span></span>
<span></span>
<span><span class="co"># posterior_expdecay &lt;- BICAM(dat = dat,</span></span>
<span><span class="co">#                          M = 3,</span></span>
<span><span class="co">#                          adapt = 2000,</span></span>
<span><span class="co">#                          burn = 100,</span></span>
<span><span class="co">#                          it = 100,</span></span>
<span><span class="co">#                          model = "ExpDecay",</span></span>
<span><span class="co">#                          dis = dis)</span></span>
<span></span>
<span><span class="co">##################### Tree Covariance Structure Model #####################</span></span>
<span></span>
<span><span class="co"># WILL GET ERROR IF 'tree' MATRIX IS NOT SUPPLIED. 'tree' MUST ALSO BE INVERTIBLE.</span></span>
<span></span>
<span><span class="co"># tree &lt;- matrix(c(1,1,1,</span></span>
<span><span class="co">#                 1,2,1,</span></span>
<span><span class="co">#                 1,1,2),nrow = 3)</span></span>
<span></span>
<span><span class="co"># posterior_tree &lt;- BICAM(dat = dat,</span></span>
<span><span class="co">#                          M = 3,</span></span>
<span><span class="co">#                          adapt = 2000,</span></span>
<span><span class="co">#                          burn = 100,</span></span>
<span><span class="co">#                          it = 100,</span></span>
<span><span class="co">#                          model = "Tree",</span></span>
<span><span class="co">#                          tree = tree)</span></span>
<span></span>
<span><span class="co">### Scaled Tree</span></span>
<span></span>
<span><span class="co"># posterior_treescaled &lt;- BICAM(dat = dat,</span></span>
<span><span class="co">#                          M = 3,</span></span>
<span><span class="co">#                          adapt = 2000,</span></span>
<span><span class="co">#                          burn = 100,</span></span>
<span><span class="co">#                          it = 100,</span></span>
<span><span class="co">#                          model = "TreeScaled",</span></span>
<span><span class="co">#                          tree = tree)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="results-from-btime">Results from BTIME<a class="anchor" aria-label="anchor" href="#results-from-btime"></a>
</h2>
<p>The <em>BTIME</em> function returns a list of 6 items:<br>
1 - Posterior samples for each monitored variable<br>
2 - Computation time of entire function (not just sampling)<br>
3 - String of the JAGS model based on function inputs<br>
4 - Lists of initial values for each chain for each variable<br>
5 - Data that was input into the JAGS model<br>
6 - List of variables monitored by the JAGS model</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Chase Sakitis, Brooke Fridley.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

      </footer>
</div>






  </body>
</html>
